\chapter{Jan.~9 --- The Derivative}

\section{Defining the Derivative}
\begin{definition}
  Let $f$ be a real-valued function on an open interval
  $U \subseteq \R$. Let $x_0 \in U$, we say $f$ is
  \emph{differentiable} at $x_0$ if
  \[
    \lim_{x \to x_0} \frac{f(x) - f(x_0)}{x - x_0}
    = \lim_{h \to 0} \frac{f(x_0 + h) - f(x_0)}{h}
  \]
  exists. If it does, then this limit, denoted by
  $f'(x_0)$, is called the \emph{derivative} of $f$ at
  $x_0$.
\end{definition}

\begin{remark}
By definition, for any $\epsilon > 0$, there exists
$\delta > 0$ such that
\[
  \left|\frac{f(x) - f(x_0)}{x - x_0} - f'(x_0)\right| \le \epsilon
\]
if $|x - x_0| < \delta$ and $x \in U$. Multiplying
both sides by $|x - x_0|$ yields
\[
  |f(x) - f(x_0) - f'(x_0)(x - x_0)| \le \epsilon |x - x_0|.
\]
In other words,
\[|f(x) - \varphi(x)| \le \epsilon |x - x_0|\]
where $\varphi(x) = f(x_0) + f'(x_0)(x - x_0)$.
In other words, $\varphi(x)$ is a first-order
approximation of $f(x)$ near $x_0$.
Geometrically, this is approximating the graph of
$y = f(x)$ by the tangent line $y = \varphi(x)$.
\end{remark}

\section{Immediate Properties}
\begin{prop}
  Let $U \subseteq \R$ be an open set and $ f : U \to \R$.
  If $f$ is differentiable at $x_0 \in U$, then
  $f$ is continuous at $x_0$.
\end{prop}

\begin{proof}
  Pick any $\epsilon_0 > 0$. Then there exists
  $\delta_0 > 0$ such that whenever
  $|x - x_0| < \delta_0$ and $x \in U$,
  \[|f(x) - f(x_0) - f'(x_0)(x - x_0)| \le \epsilon_0 |x - x_0|.\]
  By the triangle inequality,
  \[
    |f(x) - f(x_0)| \le \epsilon_0 |x - x_0| + |f'(x_0)| |x - x_0| = (\epsilon_0 + |f'(x_0)|) |x - x_0|.
  \]
  Now for any $\epsilon > 0$, choose
  $\delta = \min\{\delta_0, \epsilon / (\epsilon_0 + |f'(x_0)|)\}$.
  Then
  \[
    |f(x) - f(x_0)| \le (\epsilon_0 + |f'(x_0)|) |x - x_0| < (\epsilon_0 + |f'(x_0)|) \delta \le \epsilon
  \]
  whenever $|x - x_0| < \delta$ and $x \in U$.
  Thus $f$ is continuous at $x_0$.
\end{proof}

\begin{example}
  Take the function
  \[
    f(x) = \begin{cases}
      x \sin(1/x) & \text{if } x \ne 0 \\
      0 & \text{if } x = 0.
    \end{cases}
  \]
  Note that $f$ is continuous on $\R$. For $x \ne 0$,
  continuity is clear since both $x$ and $\sin(1/x)$
  are continuous. At $x = 0$, we have
  \[
    \lim_{x \to 0} f(x) = \lim_{x \to 0} x \sin(1/x) = 0 = f(0)
  \]
  since $|x \sin(1/x)| \le |x|$ for all $x \in \R$,
  so $f$ is also continuous at $x = 0$. However,
  $f$ is not differentiable at $x = 0$. Consider the
  limit
  \[
    \lim_{x \to 0} \frac{f(x) - f(0)}{x - 0} = \lim_{x \to 0} \sin(1/x),
  \]
  which does not exist since $\sin(1/x)$ oscillates. So
  $f$ is not differentiable at $x = 0$.
\end{example}

\begin{example}
  Take the function $f(x) = |x|$, which is continuous
  everywhere on $\R$. However, $f$ is not differentiable at
  $x = 0$, since
  \[
    \lim_{x \to 0} \frac{f(x) - f(0)}{x - 0} = \lim_{x \to 0} \frac{|x|}{x}.
  \]
  Note that
  \[
    \frac{|x|}{x} = \begin{cases}
      1 & \text{if } x > 0 \\
      -1 & \text{if } x < 0,
    \end{cases}
  \]
  so the limit does not exist as $x \to 0$. Thus
  $f$ is not differentiable at $x = 0$.
\end{example}

\begin{remark}
  For the previous example, we can however define
  the \emph{left (right) derivative} by
  \[
    f_-'(x_0) = \lim_{x \to x_0^-} \frac{f(x) - f(x_0)}{x - x_0}
  \quad \text{and} \quad f_+'(x_0) = \lim_{x \to x_0^+} \frac{f(x) - f(x_0)}{x - x_0}.
  \]
  If $f$ is differentiable, then
  $f_-'(x_0) = f_+'(x_0)$. In the previous example,
  $f_-'(0) = -1$ and $f_+'(0) = 1$. For the first
  example however, even $f_{\pm}'(0)$ does not exist.
\end{remark}

\begin{remark}
  In one dimension, the existence of the derivative
  implies that the function is differentiable (the
  function is approximated by a linear function). However,
  in multiple dimensions, the existence of partial
  derivatives does not imply differentiability.
\end{remark}

\section{Rules for Differentiation}
\begin{prop}
  Let $U \subseteq \R$ be open and $f, g : U \to \R$
  be differentiable. Then
  \begin{enumerate}
    \item $(f + g)'(x_0) = f'(x_0) + g'(x_0)$
    \item $(fg)'(x_0) = f'(x_0)g(x_0) + f(x_0)g'(x_0)$
    \item $(f/g)'(x_0) = (f'(x_0)g(x_0) - f(x_0)g'(x_0)) / (g(x_0)^2)$.
  \end{enumerate}
\end{prop}

\begin{proof}
  Find in textbook (Rosenlicht).
\end{proof}

\begin{prop}
  We have $\frac{d}{dx}(c) = 0$, $\frac{d}{dx}(x) = 1$,
  and $\frac{d}{dx}(x^n) = nx^{n - 1}$ for all $n \in \N$.
\end{prop}

\begin{proof}
  We prove the last claim (the power rule) for
  $n \ge 1$ by induction. The base case
  $n = 1$ is the first claim which is true. Now suppose
  that the result holds for any $n \le k \in \N$, and
  we show that it remains true for $n = k + 1$. By
  the product rule, we have
  \[
    \frac{d}{dx} (x^{k + 1})
    = \frac{d}{dx} (x \cdot x^k)
    = \frac{d}{dx}(x) \cdot x^k + x \cdot \frac{d}{dx}(x^k) = x^k + xkx^{k - 1} = (k + 1)x^k.
  \]
  Thus by induction this holds for all $n \ge 1$.
  We can do negative integers by the quotient rule.
\end{proof}

\begin{remark}
  The power rule actually holds for any $n \in \R$.
\end{remark}

\begin{prop}[Chain rule]
  Let $U$ and $V$ be open sets of $\R$ and let
  $f : U \to V, g : V \to \R$ be differentiable.
  Let $x_0 \in U$ be such that $f'(x_0)$ and
  $g'(f(x_0))$ exist. Then $(g \circ f)'(x_0)$ exists
  and
  \[(g \circ f)'(x_0) = g'(f(x_0)) f'(x_0).\]
\end{prop}

\begin{proof}
  For any fixed $y_0$ for which $g'(y_0)$ exists,
  set
  \[
    A(y, y_0) =
    \begin{cases}
      (g(y) - g(y_0)) / (y - y_0) & \text{if } y \in V \text{ and } y \ne y_0 \\
      g'(y_0) & \text{if } y = y_0.
    \end{cases}
  \]
  Then $A$ is continuous at $y_0$. To find
  $(g \circ f)'(x_0)$, observe that
  \begin{align*}
    \lim_{x \to x_0} \frac{g(f(x)) - g(f(x_0))}{x - x_0}
    &= \lim_{x \to x_0} \frac{A(f(x), f(x_0))(f(x) - f(x_0))}{x - x_0} \\
    &= \lim_{x \to x_0} A(f(x), f(x_0)) \lim_{x \to x_0}\frac{f(x) - f(x_0)}{x - x_0}
    = g'(f(x_0)) f'(x_0),
  \end{align*}
  by the continuity of $A$ at $f(x_0)$ and the
  differentiability of $f$ at $x_0$.
\end{proof}

\begin{remark}
  The rough idea of what we did here is
  \begin{align*}
    \lim_{x \to x_0} \frac{g(f(x)) - g(f(x_0))}{x - x_0}
    &= \lim_{x \to x_0} \frac{g(f(x)) - g(f(x_0))}{f(x) - f(x_0)} \frac{f(x) - f(x_0)}{x - x_0} \\
    &= \lim_{x \to x_0} \frac{g(f(x)) - g(f(x_0))}{f(x) - f(x_0)} \lim_{x \to x_0} \frac{f(x) - f(x_0)}{x - x_0}
    = g'(f(x_0)) f'(x_0).
  \end{align*}
  But does not quite work as stated since
  it might be that $f(x) = f(x_0)$ even if $x \ne x_0$.
  We can fix this by introducing the function $A$
  as we did in the proof, though the overall idea is
  the same.
\end{remark}

\begin{remark}
  If $f$ is monotone near $x_0$, then we can define
  the \emph{inverse function} $f^{-1}$ so that
  $(f^{-1} \circ f)(x) = x$ near $x_0$. If
  $f'(x_0)$ exists, then by the chain rule
  applied to $x = (f^{-1} \circ f)(x)$ at $x = x_0$
  we have
  \[
    1 = \frac{d}{dx}(f^{-1} \circ f)(x_0)
    = \frac{d}{dx} f^{-1}(f(x_0)) \cdot f'(x_0)
    \implies \frac{d}{dx} f^{-1}(f(x_0)) = \frac{1}{f'(x_0)}.
  \]
\end{remark}

\begin{example}
  Let $f(x) = e^x$ with $f^{-1}(x) = \ln(x)$. Since
  $f'(x) = f(x) = e^x$, we have
  \[\frac{d}{dx} f^{-1}(f(x_0)) = \frac{1}{f'(x_0)} \implies
    \frac{d}{dx} \ln(e^{x_0}) = \frac{1}{e^{x_0}}.
  \]
  Letting $e^{x_0} = h$, we have
  $\left.\frac{d}{dx} \ln(x)\right|_{x = h} = 1 / h$,
  which recovers the familiar formula.
\end{example}
