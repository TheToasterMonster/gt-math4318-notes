\chapter{Feb.~15 --- Absolute Convergence}

\section{Example of the Root Test}
\begin{example}
  Determine the converge of the series
  \[
    \sum_{n = 1}^\infty \frac{n!}{n^{\sqrt{n}}}.
  \]
\end{example}

\begin{proof}
  By Stirling's formula,
  \[
    n! \sim \left(\frac{n}{e}\right)^n \sqrt{2\pi n},
  \]
  in the sense that their ratio tends to $1$ as
  $n \to \infty$. Then
  \[
    \sqrt[n]{a_n} \sim \frac{n}{e} (2\pi)^{1 / 2n} n^{1 / 2n - 1 / \sqrt{n}},
  \]
  Note that $(2\pi)^{1 / 2n} \to 1$ as $n \to \infty$
  since $2\pi$ is a constant, and
  \[
    \ln(n^{1 / 2n - 1 / \sqrt{n}})
    = \left(\frac{1}{2n} - \frac{1}{\sqrt{n}}\right) \ln n
    = \frac{\ln n}{\frac{1}{1 / 2n - 1 / \sqrt{n}}}
    = \frac{\ln n}{2n / \sqrt{1 - 2\sqrt{n}}}
    \sim \frac{\ln n}{2n} = \frac{1 / n}{2} \to 0
  \]
  by L'H\^opital's rule, so $n^{1 / 2n - 1 / \sqrt{n}} \to 1$
  as $n \to \infty$. Then
  $\sqrt[n]{a_n} \sim n / e \gg 1$,
  so this series diverges.
\end{proof}

\section{The Integral Test}
\begin{theorem}[Integral test]
  Let $\{a_n\}$  be a positive decreasing sequence. If
  there exists a continuous decreasing $f(x)$ on
  $[1, \infty)$ such that $a_n = f(n)$, then
  \[
    \sum_{n = 1}^\infty a_n \text{ converges} \quad \text{if and only if} \quad
    \int_1^\infty f(x) \, dx \text{ converges}.
  \]
\end{theorem}

\begin{proof}
  $(\Leftarrow)$ Suppose that
  \[
    \int_1^\infty f(x) \, dx.
  \]
  converges, i.e. the limit
  \[
    \lim_{A \to \infty} \int_1^A f(x) \, dx
  \]
  exists. Then
  \[
    a_k = f(k) = f(k)[k - (k - 1)] \le \int_{k - 1}^k f(x) \, dx
  \]
  since $f$ is decreasing. So
  \[
    \sum_{k = 2}^n a_k \le \sum_{k = 2}^n \int_{k - 1}^k f(x) \, dx
    = \int_1^n f(x)\, dx.
  \]
  Since the integral converges as $n \to \infty$, the
  partial sums of $\sum_{n = 1}^\infty a_n$ are bounded,
  so $\sum_{n = 1}^\infty a_n$ converges by the
  monotone convergence theorem since $a_n \ge 0$.

  $(\Rightarrow)$ Suppose
  \[
    \sum_{n = 1}^\infty a_n
  \]
  converges. Then
  \[
    a_k = f(k)[(k + 1) - k] \ge \int_k^{k + 1} f(x) \, dx
  \]
  since $f$ is decreasing. So
  \[
    \sum_{k = 1}^n a_k \ge \sum_{k = 1}^n \int_k^{k + 1} f(x) \, dx
    = \int_1^{n + 1} f(x) \, dx.
  \]
  Since the sum converges as $n \to \infty$, the
  integral is bounded and thus converges as $f(x) \ge 0$.
\end{proof}

\begin{example}
  For $p > 1$, show that
  \[
    \sum_{n = 1}^\infty \frac{1}{n^p}
  \]
  converges if and only if $p > 1$.
\end{example}

\begin{proof}
  Let $a_n = 1 / n^p$ and choose
  \[
    f(x) = \frac{1}{x^p}
  \]
  for $x > 0$ and note that $f(n) = a_n$.
  Then look at the integral
  \[
    \int_1^\infty \frac{1}{x^p}\, dx,
  \]
  where we can appeal to integration rules to see
  that this integral converges if and only if
  $p > 1$.
\end{proof}

\begin{example}
  Show that
  \[
    \sum_{n = 2}^\infty \frac{1}{n (\ln n)^p}
  \]
  converges if and only if $p > 1$.
\end{example}

\begin{proof}
  Look at
  \[
    \int_2^\infty \frac{1}{x (\ln x)^p}\, dx
    = \left[\frac{1}{-p + 1} (\ln x)^{-p + 1}\right]_{x = 2}^{x = \infty},
  \]
  which converges if and only if $p > 1$.
\end{proof}

\begin{example}
  Suppose $a_n > 0$ and let $S_n = \sum_{k = 1}^n a_k$.
  Then
  \begin{enumerate}
    \item $\displaystyle \sum_{n = 1}^\infty \frac{a_{n + 1}}{S_n \ln S_n}$ diverges if $\displaystyle \sum_{n = 1}^\infty a_n$ diverges,
    \item and $\displaystyle \sum_{n = 1}^\infty \frac{a_{n + 1}}{S_n (\ln S_n)^2}$ converges if $\displaystyle \sum_{n = 1}^\infty a_n$ converges.
  \end{enumerate}
\end{example}

\begin{proof}
  (1) Notice $a_n = S_n - S_{n - 1} > 0$, so
  \[
    \frac{a_{n + 1}}{S_n \ln S_n}
    = \frac{S_{n + 1} - S_n}{S_n \ln S_n}
    \ge \int_{S_n}^{S_{n + 1}} \frac{1}{x \ln x}\, dx
    = \ln(\ln S_{n + 1}) - \ln(\ln S_n).
  \]
  So we see that
  \[
    \sum_{k = 1}^n \frac{a_{k + 1}}{S_k \ln S_k}
    \ge \ln(\ln S_{n + 1}) - \ln(\ln a_1)
  \]
  since the sum telescopes. But
  $\ln(\ln S_{n + 1}) \to \infty$ as $n \to \infty$,
  so this sum diverges.

  The proof for (2) is left as an exercise, but the
  idea is similar.
\end{proof}

\begin{remark}
  If $a_n = 1$, then $S_n = n$ for all $n$, which implies
  that
  \[
    \sum_{n = 1}^\infty \frac{1}{n \ln n} \text{ diverges}
    \quad \text{and} \quad
    \sum_{n = 1}^\infty \frac{1}{n (\ln n)^2} \text{ converges},
  \]
  which matches the previous example.
\end{remark}

\begin{example}
  Let $f(x_0)$ be positive and decreasing no
  $[0, \infty)$. Then
  \[
    (A) = \int_a^\infty f(x)\, dx \text{ converges} \quad
  \text{if and only if} \quad
  (B) = \int_a^\infty f(x) \sin^2 x\, dx \text{ converges}.
  \]
\end{example}

\begin{proof}
  $(\Rightarrow)$ This direction is obvious since
  $0 \le f(x) \sin^2 x \le f(x)$ at every point.

  $(\Leftarrow)$ Suppose otherwise that $(A)$ diverges. Then
  \[
    \infty = \int_a^\infty f(x)\, dx
    = \sum_{n = 0}^\infty \int_{a + n\pi}^{a + (n + 1)\pi}
    f(x)\, dx
    \le \pi \sum_{n = 0}^\infty f(a + n\pi)
  \]
  since $f$ is decreasing. This implies that
  $\sum_{n = 0}^\infty f(a + n\pi)$ diverges. But then
  \[
    \int_a^\infty f(x) \sin^2 x\, dx
    \ge \sum_{n = 0}^\infty f(a + (n + 1)\pi) \int_{a + n\pi}^{a + (n + 1)\pi} \sin^2 x\, dx
    = \frac{\pi}{2}\sum_{n = 0}^\infty f(a + (n + 1)\pi),
  \]
  so we see that
  \[
    \int_a^\infty f(x) \sin^2 x\, dx
  \]
  diverges since $\sum_{n = 1}^\infty f(a + n\pi)$ diverges. Contradiction.
\end{proof}

\section{Absolute and Conditional Convergence}

\begin{definition}
  For a series $(A) = \sum_{n = 1}^\infty a_n$, if
  $\sum_{n = 1}^\infty |a_n|$ converges, then we say that
  $(A)$ \emph{converges absolutely}. If $(A)$ converges
  but $\sum_{n = 1}^\infty |a_n|$ diverges, then we say
  that $(A)$ \emph{converges conditionally}.
\end{definition}

\begin{example}
  The series
  \[
    \sum_{n = 1}^\infty (-1)^{n + 1} \frac{1}{n}
    = 1 - \frac{1}{2} + \frac{1}{3} - \frac{1}{4} + \dots
  \]
  converges conditionally. This is because the series
  itself converges by the alternating series test (which
  we will see later), but
  taking absolute values gives the harmonic series,
  which diverges.
\end{example}

\begin{example}
  For $p > 1$, the series
  \[
    \sum_{n = 1}^\infty (-1)^{n + 1} \frac{1}{n^p}
  \]
  converges absolutely. Unlike before, taking absolute
  values gives a $p$-series, which converges for $p > 1$.
\end{example}

\begin{definition}
  For any $a_n \in \R$, define the \emph{positive} and
  \emph{negative parts} of $a_n$ by
  \[
    a_n^+ =
    \begin{cases}
      a_n & \text{if } a_n \ge 0, \\
      0 & \text{if } a_n < 0,
    \end{cases}
    \quad \text{and} \quad
    a_n^- =
    \begin{cases}
      -a_n & \text{if } a_n \le 0, \\
      0 & \text{if } a_n > 0.
    \end{cases}
  \]
  Note that $a_n^+, a_n^- \ge 0$ and
  in particular, $a_n = a_n^+ - a_n^-$ and
  $|a_n| = a_n^+ + a_n^-$.
\end{definition}

\begin{theorem}
  Suppose $\sum_{n = 1}^\infty a_n$ converges absolutely.
  Then
  \begin{enumerate}
    \item $\sum_{n = 1}^\infty a_n^+$ and
    $\sum_{n = 1}^\infty a_n^-$ converge absolutely,
  \item and $\left|\sum_{n = 1}^\infty a_n\right| \le \sum_{n = 1}^\infty |a_n|$.
  \end{enumerate}
\end{theorem}

\begin{proof}
  (1) Write
  \[
    \sum_{n = 1}^\infty |a_n|
    = \sum_{n = 1}^\infty (a_n^+ + a_n^-).
  \]
  Since $a_n^+, a_n^- \ge 0$, this implies that
  $\sum_{n = 1}^\infty a_n^+$ and
  $\sum_{n = 1}^\infty a_n^-$ converge since they
  are bounded.

  (2) Note that
  \[
    \left|\sum_{k = 1}^n a_k\right|
    \le \sum_{k = 1}^n |a_k|
  \]
  in the finite case. Then let $n \to \infty$
  to get
  \[
    \left|\sum_{k = 1}^\infty a_k\right|
    \le \sum_{k = 1}^\infty |a_k|,
  \]
  which is the desired result.
\end{proof}

\begin{example}
  Does the series
  \[
    \sum_{n = 1}^\infty
    \left[\frac{\cos n}{\sqrt[3]{n^2}} - \sin\left(\frac{\cos n}{\sqrt[3]{n^2}}\right)\right]
  \]
  converge absolutely?
\end{example}

\begin{proof}
  Let
  \[
    a_n = 
    \frac{\cos n}{\sqrt[3]{n^2}} - \sin\left(\frac{\cos n}{\sqrt[3]{n^2}}\right)
  \]
  and Taylor expand to get
  \[
    a_n = \frac{\cos n}{\sqrt[3]{n^2}} - \left(\frac{\cos n}{\sqrt[3]{n^2}} + O(1 / n^2)\right)
    = O(1 / n^2).
  \]
  Since $\sum_{n = 1}^\infty 1 / n^2$ converges, we see
  that $\sum_{n = 1}^\infty a_n$ converges absolutely.
\end{proof}

\subsection{The Alternating Series Test}
\begin{definition}
  A series of the form
  \[
    \sum_{n = 1}^\infty (-1)^n a_n
    = a_1 - a_2 + a_3 - a_4 + \dots
  \]
  where $a_n > 0$ is called an \emph{alternating series}.
\end{definition}

\begin{theorem}[Leibniz test]
  Suppose $\{a_n\}_{n = 1}^\infty$ is a decreasing
  sequence and $\lim_{n \to \infty} a_n = 0$. Then
  the infinite series $\sum_{n = 1}^\infty (-1)^{n + 1} a_n$
  converges.
\end{theorem}

\begin{proof}
  Let
  \[
    S_n = \sum_{k = 1}^n (-1)^{k + 1} a_k.
  \]
  Then we have
  \[
    S_{2n} = (a_1 - a_2) + (a_3 - a_4) + \dots + (a_{2n - 1} - a_{2n})
    \ge S_{2n - 2} \ge 0
  \]
  and also that
  \[
    S_{2n} = a_1 - (a_2 - a_3) - (a_4 - a_5) - \dots - (a_{2n - 2} - a_{2n - 1}) - a_{2n} \le a_1
  \]
  since $\{a_n\}$ is decreasing. In particular,
  $S_{2n}$ is bounded and increasing, so
  \[
    S = \lim_{n \to \infty} S_{2n}
  \]
  exists by the monotone convergence theorem. Now
  observe that
  \[
    S_{2n + 1} = S_{2n} + a_{2n + 1},
  \]
  so taking $n \to \infty$ gives
  $S_{2n + 1} \to S$ since $S_{2n} \to S$ and
  $a_{2n + 1} \to 0$. Thus $\lim_{n \to \infty} S_n = S$.
\end{proof}

\begin{remark}
  This shows that the series
  \[
    \sum_{n = 1}^\infty (-1)^{n + 1} \frac{1}{n}
  \]
  from earlier indeed converges.
\end{remark}

\begin{remark}
  The proof also gives an error estimate for an
  alternating series. We have
  \[
    |S_n - S| \le a_{n + 1}
  \]
  since
  $|S_n - S| = a_{n + 1} - (a_{n + 2} - a_{n + 3}) + \dots
    \le a_{n + 1}$.
  We get this since the tail is still an alternating
  series, and an alternating series is bounded by its
  first term, as shown in the proof.
\end{remark}
