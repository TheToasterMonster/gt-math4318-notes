\chapter{Jan.~16 --- Taylor's Theorem}

\section{Darboux's Lemma}
\begin{lemma}[Darboux's lemma]
  If $f$ is differentiable in $(a, b)$, continuous
  on $[a, b]$ and $f'(a) < f'(b)$, then for any
  $c \in (f'(a), f'(b))$, there exists $x_0 \in (a, b)$
  such that $f'(x_0) = c$.
\end{lemma}

\begin{proof}
  See homework.
\end{proof}

\begin{remark}
  There exists an example of a differentiable function
  $f(x)$ but $f'(x)$ is not continuous, e.g.
  \[
    f(x) =
    \begin{cases}
      x^2 \sin(1/x) & \text{if } x \ne 0 \\
      0 & \text{if } x = 0.
    \end{cases}
  \]
  We can compute that
  \[
    f'(x) =
    \begin{cases}
      2x \sin(1/x) - \cos(1/x) & \text{if } x \ne 0 \\
      0 & \text{if } x = 0,
    \end{cases}
  \]
  and we can verify as an exercise that $f'(x)$ is not
  continuous at $x = 0$.
\end{remark}

\begin{remark}
  Darboux's lemma guarantees that $g'(x) \ne 0$ implies
  either $g'(x) > 0$ or $g'(x) < 0$ everywhere in
  the conditions for Cauchy's mean value theorem.
\end{remark}

\section{L'H\^opital's Rule}
\begin{theorem}[L'H\^opital's rule, $0 / 0$]
  Let $f, g$ be differentiable in $(a, b)$,
  $\lim_{x \to a^+} f(x) = \lim_{x \to a^+} g(x) = 0$,
  and $g'(x) \ne 0$ for any $x \in (a, b)$. Then
  if $\lim_{x \to a^+} f'(x)/g'(x)$ exists, we have
  \[
    \lim_{x \to a^+} \frac{f(x)}{g(x)} = \lim_{x \to a^+} \frac{f'(x)}{g'(x)}.
  \]
\end{theorem}

\begin{proof}
  By Cauchy's theorem, for any $x \in (a, b)$, there
  exists $\xi(x) \in (a, x)$ such that
  \[
    \frac{f(x)}{g(x)} = \frac{f(x) - f(a)}{g(x) - g(a)}
    = \frac{f'(\xi(x))}{g'(\xi(x))}.
  \]
  If $x \to a^+$, then $\xi(x) \to a^+$, so
  \[
    \lim_{x \to a^+} \frac{f(x)}{g(x)}
    = \lim_{x \to a^+} \frac{f'(\xi(x))}{g'(\xi(x))}
    = \lim_{x \to a^+} \frac{f'(x)}{g'(x)},
  \]
  as desired.
\end{proof}

\begin{corollary}
  Let $f, g$ be differentiable in $(a, \infty)$,
  $\lim_{x \to \infty} f(x) = \lim_{x \to \infty} g(x) = 0$,
  and $g'(x) \ne 0$ for any $x \in (a, \infty)$. Then
  if $\lim_{x \to \infty} f'(x)/g'(x)$ exists, we have
  \[
    \lim_{x \to \infty} \frac{f(x)}{g(x)} = \lim_{x \to \infty} \frac{f'(x)}{g'(x)}.
  \]
\end{corollary}

\begin{proof}
  Assume $a > 0$. Define $\widetilde{f}(y) = f(1/y)$ and
  $\widetilde{g}(y) = g(1/y)$ with $y \in (0, 1 / a)$.
  By L'H\^opital's rule,
  \[
    \lim_{y \to 0^+} \frac{\widetilde{f}(y)}{\widetilde{g}(y)}
    = \lim_{y \to 0^+} \frac{\widetilde{f}'(y)}{\widetilde{g}'(y)}
    = \lim_{y \to \infty} \frac{f'(1 / y) \cdot (-1 / y^2)}{g'(1 / y) \cdot (-1 / y^2)}
    = \lim_{x \to \infty} \frac{f'(x)}{g'(x)},
  \]
  as desired.
\end{proof}

\begin{theorem}[L'H\^opital, $\infty / \infty$]
  Let $f, g$ be differentiable in $(a, b)$,
  $\lim_{x \to a^+} |f(x)| = \lim_{x \to a^+} |g(x)| = \infty$,
  and $g'(x) \ne 0$ for any $x \in (a, b)$. Then
  if $\lim_{x \to a^+} f'(x)/g'(x)$ exists, we have
  \[
    \lim_{x \to a^+} \frac{f(x)}{g(x)} = \lim_{x \to a^+} \frac{f'(x)}{g'(x)}.
  \]
\end{theorem}

\begin{proof}
  Left as an exercise.
\end{proof}

\begin{remark}
  Saying that the absolute values of $f$ and $g$ go to
  infinity works, since the existence of the limit rules
  out oscillatory behavior.
\end{remark}

\begin{remark}
  These cases of $\infty / \infty$ and $0 / 0$ are
  are called \emph{indefinite types}. Other indefinite
  types include $0 \cdot \infty$, $0^0$, $\infty^0$
  $1^\infty$, $\infty - \infty$, etc. But we can try
  to reduce them to the cases we know. For example,
  if $f(x) \to 0^+$ and $g(x) \to 0^+$ when $x \to x_0$,
  then $\lim_{x \to x_0} f(x)^{g(x)}$ is $0^0$.
  Letting $y(x) = f(x)^{g(x)}$, we can take the log
  to get
  \[
    \ln y(x) = g(x) \ln f(x) = \frac{\ln f(x)}{1 / g(x)}
    = \frac{\infty}{\infty}.
  \]
\end{remark}

\begin{example}
  We can see that (this is a $\infty - \infty$ case)
  \[
    \lim_{x \to 0^+} \frac{1}{x^2} - \frac{\cot x}{x}
    = \lim_{x \to 0^+} \frac{1 + x \cot x}{x^2}
    = \lim_{x \to 0^+} \frac{-(\cot x - x \csc^2 x)}{2x \sin^2 x}.
  \]
  Note that $x \cot x = x \cos x / \sin x \to 1$ as
  $x \to 0$. Now note that $\sin x / x \to 1$ as $x \to 0$,
  so we continue with
  \[
    \lim_{x \to 0^+} \frac{-(\cot x - x \csc^2 x)}{2x \sin^2 x}
    = \lim_{x \to 0^+} \frac{x - \sin x \cos x}{2x^3} \frac{x^2}{\sin^2 x}
  \]
  Since $x^2 / \sin^2 x \to 1$ as $x \to 0$, we can
  look at the remaining part to get
  \[
    \lim_{x \to 0^+} \frac{x - \sin x \cos x}{2x^3}
    = \lim_{x \to 0^+} \frac{1 - \cos 2x}{6x^2}
    = \lim_{x \to 0^+} \frac{2 \sin 2x}{12x} = \frac{1}{3}.
  \]
  So $\lim_{x \to 0^+} (1 / x^2 - \cot x / x) = 1 / 3$.
\end{example}

\section{Taylor's Theorem}
\begin{theorem}[Peano remainder term]
  Let $f : [a, b] \to \R$ be differentiable at $x = a$
  up to $n$th order of derivatives, i.e.
  $f'(a), f''(a), \dots, f^{(n)}(a)$ exist. Then as
  $x \to a^+$, we have
  \[f(x) = \sum_{k = 0}^n \frac{f^{(k)}(a)}{k!}(x - a)^k + o((x - a)^n).\]
  Call the polynomial part of the above $P_n(x)$, which
  is also known as the \emph{Taylor polynomial} of order $n$.
\end{theorem}

\begin{proof}
  To show that the error term is $o((x - a)^n)$, we have
  \[
    \lim_{x \to a^+} \frac{f(x) - P_n(x)}{(x - a)^n}
    = \lim_{x \to a^+} \frac{f'(x) - P_n'(x)}{n(x - a)^{n - 1}}
    = \frac{1}{n!} \lim_{x \to a^+} \left[\frac{f^{n - 1}(x) - f^{n - 1}(a)}{x - a} - f^{(n)}(a)\right] = 0
  \]
  by L'H\^opital's rule, where we used the observation
  that
  $f^{(k)}(a) = P_n^{(k)}(a)$ for $1 \le k \le n$.
  The final step is a result of the existence of $f^{(n)}(a)$.
\end{proof}

\begin{lemma}[Rolle's theorem for higher order derivatives]
  Let $f \in C^n([a, b])$ and differentiable to
  $(n + 1)$ order. If $f'(a) = \dots = f^{(n)}(a) = 0$
  and $f(a) = f(b)$, then there exists $x_0 \in (a, b)$
  such that $f^{(n + 1)}(x_0) = 0$.
\end{lemma}

\begin{proof}
  Since $f(a) = f(b)$, by the usual Rolle's theorem
  there exists $x_1 \in (a, b)$ such that $f'(x_1) = 0$.
  Then since $f'(a) = f'(x_1) = 0$, by
  Rolle's theorem again,
  there exists $x_2 \in (a, x_1)$ such that $f''(x_2) = 0$.
  Repeat this to get $x_{n + 1} \in (a, x_n) \subseteq (a, b)$ such that
  $f^{(n + 1)}(x_{n + 1}) = 0$. Take $x_0 = x_{n + 1}$
  to finish.
\end{proof}

\begin{theorem}[Lagrange remainder term]
  Let $f \in C^n([a, b])$, in particular,
  $f'(a), \dots, f^{(n)}(a)$ exist. Additionally,
  assume $f$ is $(n + 1)$-th differentiable in $(a, b)$.\footnote{Note that the $(n + 1)$-th derivative need not be continuous here.}
  Then
  \[
    f(x) = \sum_{k = 0}^n \frac{f^{(k)}(a)}{k!}(x - a)^k + R_n(x) \quad \text{where} \quad R_n(x) = \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - a)^{n + 1}
  \]
  for some $\xi \in [a, x]$.
\end{theorem}

\begin{proof}
  Define $P(x) = P_n(x) + \lambda (x - a)^{n + 1}$, where
  we choose $\lambda \in \R$ such that $P(b) = f(b)$, i.e.
  \[
    \lambda = \frac{f(b) - P_n(b)}{(b - a)^{n + 1}}.
  \]
  Consider $g(x)  = f(x) - P(x)$, which satisfies
  $g(a) = g(b) = 0$ and $g'(a) = \dots = g^{(n)}(a) = 0$.
  Then by Rolle's theorem (higher order), there exists
  $\xi \in (a, b)$ such that $g^{(n + 1)}(\xi) = 0$.
  In other words,
  \[
    f^{(n + 1)} - P^{(n + 1)}(\xi) = 0
    \implies f^{(n + 1)}(\xi) - (n + 1)! \underbrace{\frac{f(b) - P_n(b)}{(b - a)^{n + 1}}}_{\lambda} = 0.
  \]
  This implies that
  \[
    f(b) = P_n(b) + \frac{1}{(n + 1)!} f^{(n + 1)}(\xi) (b - a)^{n + 1},
  \]
  and since we picked $b$ arbitrarily (kind of),
  we can take $b = x$ and we are done since
  $\xi \in [a, b]$.
\end{proof}

\begin{remark}
  The choice of $\xi$ in Lagrange's remainder term
  may (and likely does) vary for different $x$.
\end{remark}

\begin{remark}
  The Taylor polynomial is unique in the sense that
  if $f : [a, b] \to \R$ and $f'(a), \dots, f^{(n)}(a)$
  exist, then if
  \[f(x) = p(x) + o((x - a)^n)\]
  as $x \to a^+$ for some polynomial $p(x)$ with
  $\deg p \le n$, then
  $p(x) = P_n(x) = \sum_{k = 0}^n \frac{f^{(k)}(a)}{k!} (x - a)^k$.
  This is because if $Q(x) = p(x) - P_n(x)$, then
  by Taylor's formula (Peano form), we get
  \[
    \lim_{x \to a^+} \frac{Q(x)}{(x - a)^n}
    = \lim_{x \to a^+} \frac{p(x) - \sum_{k = 0}^n \frac{f^{(k)}(a)}{k!} (x - a)^k}{(x - a)^n} = 0.
  \]
  From here this implies that $Q(x) = 0$ since $\deg Q \le n$.
\end{remark}
